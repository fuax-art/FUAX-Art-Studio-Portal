<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUAX Metadata Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #000;
            color: #00ffff;
        }
        #vanta-bg {
            position: fixed;
            inset: 0;
            z-index: -10;
            opacity: 0.3;
        }
        .container {
            background: rgba(0, 0, 0, 0.85);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #cd5c28;
        }
        button {
            background: #cd5c28;
            color: #00ffff;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #b34a20;
        }
        input, select {
            background: rgba(0, 0, 0, 0.7);
            color: #00ffff;
            border: 1px solid #cd5c28;
            padding: 8px;
            border-radius: 4px;
        }
        textarea {
            width: 100%;
            height: 400px;
            background: rgba(0, 0, 0, 0.9);
            color: #00ffff;
            border: 1px solid #cd5c28;
            padding: 10px;
            font-family: monospace;
        }
        .trait-set {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            background: rgba(205, 92, 40, 0.3);
            border: 2px solid #cd5c28;
            border-radius: 8px;
            cursor: pointer;
        }
        .trait-set.active {
            background: #cd5c28;
            color: #000;
        }
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #00ffff;
        }
    </style>
</head>
<body>
    <div id="vanta-bg"></div>
    <script>
        VANTA.GLOBE({
            el: "#vanta-bg",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200,
            minWidth: 200,
            scale: 1.00,
            scaleMobile: 1.00,
            color: 0x00ffff,
            backgroundColor: 0x000000
        })
    </script>

    <div class="container">
        <div style="text-align:center; margin-bottom:1.5em;">
            <div style="font-size:1.8em; font-weight:bold; color:#00ffff; letter-spacing:2px;">Forever Unfinished Artworx <span style="font-size:0.9em; color:#cd5c28;">(FUAX)</span></div>
            <div style="font-size:1.1em; color:#00cccc; margin-top:0.3em;">Metadata Generator</div>
        </div>

        <div class="controls">
            <div>
                <label>Number of Entries (1-100):</label>
                <input type="number" id="entryCount" min="1" max="100" value="13">
            </div>
            <div>
                <label>Custom Name Prefix (optional):</label>
                <input type="text" id="namePrefix" placeholder="e.g. CyberPug">
            </div>
        </div>

        <div style="margin: 20px 0;">
            <h3 style="color:#00ffff;">Select Trait Set:</h3>
            <div class="trait-set active" onclick="selectTraitSet('cyber', this)">Cyber/Tech</div>
            <div class="trait-set" onclick="selectTraitSet('monster', this)">Monster</div>
            <div class="trait-set" onclick="selectTraitSet('human', this)">Human</div>
            <div class="trait-set" onclick="selectTraitSet('alien', this)">Alien</div>
        </div>

        <button onclick="generateMetadata()">üöÄ Generate Metadata</button>
        <button onclick="generateRandomNames()">üé≤ Generate Random Names</button>
        <button onclick="toggleTableView()">üìä Toggle Table View</button>
        <button onclick="clearOutput()">üóëÔ∏è Clear</button>
        <button onclick="downloadCSV()">üì• Download CSV</button>

        <div style="margin-top: 20px;">
            <h3 style="color:#00ffff;">Output:</h3>
            <textarea id="output" placeholder="Generated metadata will appear here..."></textarea>
        </div>
        <div id="tableView" style="display:none; margin-top:20px; overflow-x:auto;">
             <h3 style="color:#00ffff;">Table View:</h3>
             <table id="metadataTable" style="width:100%; border-collapse:collapse; background:rgba(0,0,0,0.7);">
             </table>
        </div>
    </div>

    <script>
        let currentTraitSet = 'cyber';
        let generatedData = [];

        const traitSets = {
            cyber: {
                personality: { "Hacker": 50, "Gamer": 25, "Coder": 15, "Rebel": 5, "Explorer": 3, "Guardian": 1, "Nomad": 0.5, "Oracle": 0.4, "Cipher": 0.1 },
                affinity: { "Code Master": 50, "Data Analyst": 20, "Network Specialist": 15, "AI Whisperer": 10, "Crypto Expert": 4, "Archivist": 0.8, "Synthesist": 0.2 },
                energy: { "Focused": 50, "Hyper": 30, "Chill": 10, "Chaotic": 5, "Zen": 4.5, "Static": 0.5 },
                ability: { "Processing Power": 50, "Connection Speed": 30, "Firewall Strength": 15, "Encryption Key": 4.5, "Data Surge": 0.3, "Mind Weave": 0.2 },
                origin: { "Lab Creation": 40, "Street Upload": 30, "Corporate Escape": 20, "Open Source": 9.5, "Lost Code": 0.4, "Void-born": 0.1 },
                utility: { "None": 99, "High-Res Access": 0.5, "Future Airdrop": 0.4, "Genesis": 0.1 }
            },
            monster: {
                personality: { "Fierce": 30, "Cunning": 30, "Wild": 15, "Ancient": 15, "Chaotic": 5, "Primal": 2, "Unpredictable": 2, "Ghostly": 1},
                affinity: { "Shadow Walker": 35, "Night Hunter": 35, "Beast Master": 10, "Void Dweller": 10, "Soul Eater": 8, "Elemental": 2},
                energy: { "Aggressive": 35, "Dormant": 30, "Explosive": 25, "Unstable": 9, "Corrupting": 1},
                ability: { "Regeneration": 35, "Stealth": 35, "Strength": 20, "Terror Inducing": 7, "Teleportation": 3},
                origin: { "Summoned": 30, "Mutated": 30, "Ancient Awakening": 20, "Dark Ritual": 12, "Chaotic Breach": 5, "Abyssal Plain": 3},
                utility: { "None": 99, "High-Res Access": 0.5, "Future Airdrop": 0.4, "Genesis": 0.1 }
            },
            human: {
                personality: { "Leader": 20, "Strategist": 20, "Warrior": 20, "Scholar": 15, "Healer": 10, "Rogue": 10, "Innovator": 5},
                affinity: { "Combat Expert": 25, "Tactician": 25, "Diplomat": 20, "Engineer": 15, "Pilot": 10, "Survivalist": 5},
                energy: { "Determined": 30, "Calm": 25, "Intense": 20, "Adaptive": 15, "Resilient": 10},
                ability: { "Leadership": 25, "Survival Instinct": 25, "Innovation": 20, "Persuasion": 15, "Psionic": 10, "Precognition": 5},
                origin: { "Urban": 25, "Military": 25, "Academic": 20, "Underground": 15, "Hidden City": 10, "Outpost": 5},
                utility: { "None": 99, "High-Res Access": 0.5, "Future Airdrop": 0.4, "Genesis": 0.1 }
            },
            alien: {
                personality: { "Observer": 25, "Collector": 20, "Emissary": 20, "Traveler": 15, "Ancient": 10, "Architect": 8, "Watcher": 2},
                affinity: { "Telepathic": 30, "Quantum Mind": 30, "Hive Linked": 20, "Cosmic Aware": 13, "Time Bending": 5, "Dimension Walker": 2},
                energy: { "Ethereal": 25, "Pulsing": 25, "Transdimensional": 20, "Crystalline": 15, "Singularity": 10, "Cosmic Ray": 5},
                ability: { "Telekinesis": 25, "Phase Shift": 25, "Mind Link": 20, "Reality Bend": 15, "Matter Manipulation": 10, "Soul Absorb": 5},
                origin: { "Distant Star": 25, "Wormhole": 25, "Dimensional Rift": 20, "Ancient Colony": 15, "Galactic Core": 10, "Void of Creation": 5},
                utility: { "None": 99, "High-Res Access": 0.5, "Future Airdrop": 0.4, "Genesis": 0.1 }
            }
        };

        function selectTraitSet(set, element) {
            currentTraitSet = set;
            document.querySelectorAll('.trait-set').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }

        function generateRandomName() {
            const namePatterns = {
                cyber: {
                    prefixes: ["Chrono", "Pixel", "Core", "Wave", "Pulse", "Node", "Shift", "Spark", "Blast","Synth", "Zone", "Circuit", "Echo", "Cyber", "Neo", "Quantum", "Digital", "Plasma", "Neon", "Glitch", "Flux", "Binary", "Data"],
                    suffixes: ["Byte", "Chip", "Hack", "Net", "Code", "Bot", "Drone", "Grid", "Link", "Node",  "Tech", "Wave", "Core", "Pulse", "Flux", "Spark", "Shift", "Glitch", "Pixel"]
                },
                monster: {
                    prefixes: ["Fang", "Claw", "Maw", "Terror", "Bane", "Reaver", "Stalker", "Hunter", "Shadow", "Dark", "Blood", "Fang", "Claw", "Void", "Doom", "Rage", "Beast", "Primal"],
                    suffixes: ["Howl", "Snarl", "Lord", "Fiend", "Bringer", "Stalker", "Hunter", "Wraith", "Terror", "Giant", "Crusher", "Howler"]
                },
                human: {
                    prefixes: ["Strike", "Fist", "Edge", "Born", "Heart", "Soul", "Eye", "Hand", "Walker", "Runner", "Blade", "Ghost", "Viper", "Raven", "Wolf", "Hawk", "Rogue"],
                    suffixes: ["Fury", "Strike", "Shadow", "Rider", "Hunter", "Warrior", "Guardian", "Seeker", "Nomad", "Storm", "Steel", "Iron", "Thunder"]
                },
                alien: {
                    prefixes: ["Xeno", "Zeta", "Kryo", "Vex", "Nex", "Quar", "Tari", "Luma", "Orin", "Vira", "Xylo", "Zyra", "Kora", "Mira", "Nova", "Prax", "Ryn", "Sora", "Talon", "Vara", "Xeno", "Cosmic", "Void", "Star", "Nova", "Quantum", "Phase", "Warp", "Nebula", "Astral"],
                    suffixes: ["ling", "oid", "ite", "ar", "on", "arion", "ax", "ex", "us", "ar", "Form", "Entity", "Being", "Essence", "Mind", "Consciousness", "Traveler", "Observer", "Seeker", "Keeper"]
                }
            };
            
            const patterns = namePatterns[currentTraitSet];
            return patterns.prefixes[Math.floor(Math.random() * patterns.prefixes.length)] + 
                   patterns.suffixes[Math.floor(Math.random() * patterns.suffixes.length)];
        }

        function generateRandomNames() {
            const count = parseInt(document.getElementById('entryCount').value) || 9;
            let names = '';
            for (let i = 0; i < count; i++) {
                names += generateRandomName() + (i < count - 1 ? ', ' : '');
            }
            alert(`Random names generated:\n\n${names}\n\nCopy these to use as custom names!`);
        }

        function toggleTableView() {
            const table = document.getElementById('tableView');
            table.style.display = table.style.display === 'none' ? 'block' : 'none';
        }

        function randomPickWeighted(weights) {
            let sum = 0;
            for (let trait in weights) {
                sum += weights[trait];
            }
            let rand = Math.floor(Math.random() * sum);
            let cumulative = 0;
            for (let trait in weights) {
                cumulative += weights[trait];
                if (rand < cumulative) {
                    return trait;
                }
            }
        }

        function generateMetadata() {
    const count = parseInt(document.getElementById('entryCount').value) || 100;
    const namePrefix = document.getElementById('namePrefix').value || "FUAX";
    const traits = traitSets[currentTraitSet];
    generatedData = [];
    
    // Determine the number of NFTs you want to be "common"
    const numToForceCommon = Math.floor(count * 0.3); // 30% of the collection will be common
    
    // Force common NFTs
    for (let i = 1; i <= numToForceCommon; i++) {
        generatedData.push({
            id: i,
            name: `${namePrefix} #${i.toString().padStart(3, '0')}`,
            description: `A unique ${currentTraitSet} entity from the Forever Unfinished Artworx collection`,
            // Set traits to the most common ones for the selected set
            personality: Object.keys(traits.personality)[0],
            affinity: Object.keys(traits.affinity)[0],
            energy: Object.keys(traits.energy)[0],
            ability: Object.keys(traits.ability)[0],
            origin: Object.keys(traits.origin)[0],
            utility: Object.keys(traits.utility)[0],
        });
    }

    // Generate the rest of the collection randomly
    for (let i = numToForceCommon + 1; i <= count; i++) {
        generatedData.push({
            id: i,
            name: `${namePrefix} #${i.toString().padStart(3, '0')}`,
            description: `A unique ${currentTraitSet} entity from the Forever Unfinished Artworx collection`,
            personality: randomPickWeighted(traits.personality),
            affinity: randomPickWeighted(traits.affinity),
            energy: randomPickWeighted(traits.energy),
            ability: randomPickWeighted(traits.ability),
            origin: randomPickWeighted(traits.origin),
            utility: randomPickWeighted(traits.utility),
        });
    }

    // Shuffle the array to randomize the order
    generatedData.sort(() => Math.random() - 0.5);

    updateOutput();
}

        function updateOutput() {
            const traits = traitSets[currentTraitSet];
            const totalNFTs = generatedData.length;
            
            // Calculate trait frequencies
            const traitFrequencies = {};
            Object.keys(traits).forEach(category => {
                traitFrequencies[category] = {};
                generatedData.forEach(item => {
                    const value = item[category];
                    traitFrequencies[category][value] = (traitFrequencies[category][value] || 0) + 1;
                });
            });
            
            // Calculate and assign rarity for each NFT
            generatedData.forEach(item => {
                let rarityScore = 1; // Start with a score of 1 for multiplication
                item.traitRarities = {};
                
                Object.keys(traits).forEach(category => {
                    const value = item[category];
                    const frequency = traitFrequencies[category][value];
                    const rarityPercent = (frequency / totalNFTs); // Probability
                    
                    item.traitRarities[category] = {
                        value: value,
                        frequency: frequency,
                        percentage: (rarityPercent * 100).toFixed(1)
                    };
                    
                    // Rarity score based on trait probability
                    rarityScore *= (1 / rarityPercent);
                });
                
                item.rarityScore = rarityScore.toFixed(2);
                
                // Assign tier based on the new score distribution
                // These thresholds will give you a better distribution
                if (item.rarityScore >= 25000) item.rarityTier = "Legendary";
                else if (item.rarityScore >= 500) item.rarityTier = "Epic";
                else if (item.rarityScore >= 50) item.rarityTier = "Rare";
                else if (item.rarityScore >= 25) item.rarityTier = "Uncommon";
                else item.rarityTier = "Common";
            });
            
            // Sort by rarity score (highest first) for better display
            generatedData.sort((a, b) => b.rarityScore - a.rarityScore);

            // The rest of your code for output and table view can stay the same
            let csv = "ID,Name,Description,Personality,Affinity,Energy,Ability,Origin,Utility,Rarity Score,Rarity Tier\n";
            generatedData.forEach(item => {
                csv += `${item.id},"${item.name}","${item.description}","${item.personality}","${item.affinity}","${item.energy}","${item.ability}","${item.origin}","${item.utility}",${item.rarityScore},${item.rarityTier}\n`;
            });
            
            csv += "\n\n=== TRAIT RARITY BREAKDOWN ===\n";
            csv += "NFT ID,Trait Type,Trait Value,Appears In Collection,Rarity %\n";
            generatedData.forEach(item => {
                Object.keys(item.traitRarities).forEach(category => {
                    const trait = item.traitRarities[category];
                    csv += `${item.id},${category},${trait.value},${trait.frequency}/${totalNFTs},${trait.percentage}%\n`;
                });
            });
            
            document.getElementById('output').value = csv;
            
            const table = document.getElementById('metadataTable');
            table.innerHTML = `
                <thead>
                    <tr style="background:#cd5c28; color:#000;">
                        <th style="padding:10px; border:1px solid #cd5c28;">ID</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Name</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Personality</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Affinity</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Energy</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Ability</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Origin</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Utility</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Rarity</th>
                        <th style="padding:10px; border:1px solid #cd5c28;">Tier</th>
                    </tr>
                </thead>
                <tbody>
                    ${generatedData.map(item => {
                        const tierColor = 
                            item.rarityTier === "Legendary" ? "#FFD700" :
                            item.rarityTier === "Epic" ? "#9D4EDD" :
                            item.rarityTier === "Rare" ? "#3A86FF" :
                            item.rarityTier === "Uncommon" ? "#06D6A0" : "#00ffff";
                        
                        return `
                        <tr style="color:#00ffff;">
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.id}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.name}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.personality}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.affinity}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.energy}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.ability}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.origin}</td>
                            <td style="padding:8px; border:1px solid #cd5c28;">${item.utility}</td>
                            <td style="padding:8px; border:1px solid #cd5c28; font-weight:bold;">${item.rarityScore}</td>
                            <td style="padding:8px; border:1px solid #cd5c28; font-weight:bold; color:${tierColor};">${item.rarityTier}</td>
                        </tr>
                        `;
                    }).join('')}
                </tbody>
            </table>
            `;
            
            document.getElementById('tableView').style.display = 'block';
        }

        function downloadCSV() {
            if (generatedData.length === 0) {
                alert('Generate metadata first before downloading!');
                return;
            }
            
            const csvContent = document.getElementById('output').value;
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            const timestamp = new Date().toISOString().slice(0,10);
            const filename = `FUAX_metadata_${currentTraitSet}_${timestamp}.csv`;
            
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearOutput() {
            document.getElementById('output').value = '';
            document.getElementById('tableView').style.display = 'none';
            generatedData = [];
        }
    </script>
</body>
</html>
